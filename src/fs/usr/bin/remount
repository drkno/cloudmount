#!/bin/bash
. "/usr/bin/variables"

if [ -z "$(ls -A ${RCLONE_MOUNT})" ] || ! pgrep unionfs > /dev/null; then
    echo "Mount has dropped. Remount in progress."
    echo "Unmounting..."
    fusermount -uz "${PLEXDRIVE_MOUNT}"
    fusermount -uz "${RCLONE_MOUNT}"
    fusermount -uz "${UPLOAD_QUEUE}"
    fusermount -uz "${MOUNT_DIR}"
    
    echo "Unmounted successfully"
    echo "Mounting..."
    mount
    echo "Mounted successfully"
fi
